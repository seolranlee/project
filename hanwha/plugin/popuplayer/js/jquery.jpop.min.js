/**
 * jQuery Plugin for a popup
 * The popup works on images and links aswell as youtube and vimeo players
 *
 * @author Sedat Bilen
 * @licence Licensed under the MIT license
 */!function(e){var t,a={type:"img",onClick:"",onClose:"",gallery:!0},r=e("<div id='popup-modal'>"),n=e("<div id='content'>"),d=e("<div class='overlay'>"),o=e("<div id='arrows-container'>"),l=e("<div id='arrow-left'>"),i=e("<div id='arrow-right'>"),c={getVideoId:function(e){var t=e.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/);return t&&11==t[7].length?t[7]:!1},getEmbedUrl:function(e){return"https://www.youtube.com/embed/"+e+"?autoplay=1"}},p={getVideoId:function(e){var t=e.match(/http(s)?:\/\/(www\.)?vimeo.com\/(\d+)(\/)?(#.*)?/);return t?t[3]:!1},getEmbedUrl:function(e){return"https://player.vimeo.com/video/"+e+"?autoplay=1"}},u={init:function(a){a.preventDefault(),t=e(this);var r=a.data;switch(r.type){case"img":u.handleImage();break;case"iframe":u.handleFrame()}"function"==typeof r.onClick&&r.onClick.call(),r.gallery&&u.addArrows(a),u.addModal(),e("body").on("click",a.data,u.handleOverlay).on("keyup",a.data,u.handleKey)},addModal:function(){e("body").append(r.append(n))},handleImage:function(){n.empty().append("<img src='"+t.attr("href")+"' />")},handleFrame:function(){var a=t.attr("href"),r=e("<iframe frameborder='0' allowfullscreen>");0!=c.getVideoId(a)?r.attr("src",c.getEmbedUrl(c.getVideoId(a))):0!=p.getVideoId(a)?r.attr("src",p.getEmbedUrl(p.getVideoId(a))):r.attr("src",a),n.empty().append(r)},handleOverlay:function(t){e("body").has(d).length?u.removePopup(t):u.addOverlay(t)},addOverlay:function(){e("body").append(d)},addArrows:function(e){l.on("click",e.data,u.gallery.previous),i.on("click",e.data,u.gallery.next),r.append(o.append(l).append(i))},gallery:{getCurrentIndex:function(e){var t=0;return a.gallery&&(t=e.data("popup-index")),t},previous:function(a){var r=a.data,d=u.gallery.getCurrentIndex(t),o=e(r.selector).length;1!=o&&(d=0==d?o-1:d-1,t=e(r.selector+"[data-popup-index="+d+"]"),"img"==r.type&&n.find("img").attr("src",t.attr("href")),"iframe"==r.type&&u.handleFrame())},next:function(a){var r=a.data,d=u.gallery.getCurrentIndex(t),o=e(r.selector).length;1!=o&&(d=d==o-1?0:d+1,t=e(r.selector+"[data-popup-index="+d+"]"),"img"==r.type&&n.find("img").attr("src",t.attr("href")),"iframe"==r.type&&u.handleFrame())}},handleKey:function(e){var t=e.data;27==e.keyCode&&u.removePopup(e),37==e.keyCode&&t.gallery&&u.gallery.previous(e),39==e.keyCode&&t.gallery&&u.gallery.next(e)},removePopup:function(t){if(r.has(t.target).length&&"arrows-container"!=e(t.target).attr("id"))return!1;var a=t.data;"function"==typeof a.onClose&&a.onClose.call(),d.detach(),r.detach(),o.detach(),e("body").off("click",u.handleOverlay).off("keyup",u.handleKey),l.off(),i.off()}};e.fn.jPop=function(t){t&&(a=e.extend(a,t));var r={selector:this.selector};e.extend(r,a);var n=0;return this.each(function(){e(this).on("click",r,u.init),r.gallery&&e(this).attr("data-popup-index",n++)}),this}}(jQuery);